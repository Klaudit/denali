<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Quickstart</title>
  <meta name="description" content="">

  <link href='https://fonts.googleapis.com/css?family=Inconsolata|Lato:400,700|Open+Sans:400,400italic,700|Montserrat+Alternates:700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://denali.github.com/denali/guides/quickstart/">
</head>

  <body>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-2.2.2.min.js"><\/script>')</script>
    <nav class="navbar navbar-full navbar-dark">
  <div class='container'>
    <a href='/' class='navbar-brand'>
      <img class='logo-light' src='/images/logo.png' alt='Denali'>
      <span class='project-name'>denali</span>
    </a>

    <div class='nav navbar-nav pull-xs-right'>
      <li class='nav-item'>
        <a class='nav-link' href='/canary/guides/quickstart'>Quickstart</a>
      </li>
      <li class='nav-item'>
        <a class='nav-link' href='/canary/guides/introduction'>Guides</a>
      </li>
      <li class='nav-item'>
        <a class='nav-link' href='/canary/api'>API</a>
      </li>
      <li class='nav-item'>
        <a class='nav-link' href='https://github.com/davewasmer/denali' target='_blank'>Github</a>
      </li>
      <li class='nav-item'>
        <a class='nav-link' href='https://github.com/davewasmer/denali/issues' target='_blank'>Issues</a>
      </li>
    </div>
  </div>
</nav>

<div class='container'>
  <div class="row">
    <div class='guides-nav col-md-3'>

  <div class='nav-section'>
  <div class='nav-header'>Version</div>
  <select id='versions'>
    
      <option value='canary' selected='selected'>canary</option>
    
  </select>
</div>


  
    <div class='nav-section'>
      
      
        <a href='/canary/guides/introduction/' class='nav-link'>Introduction</a>
      
        <a href='/canary/guides/quickstart/' class='nav-link'>Quickstart</a>
      
        <a href='/canary/guides/app-structure/' class='nav-link'>App Structure</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>Application</div>
      
      
        <a href='/canary/guides/routing/' class='nav-link'>Routing</a>
      
        <a href='/canary/guides/actions/' class='nav-link'>Actions</a>
      
        <a href='/canary/guides/services/' class='nav-link'>Services</a>
      
        <a href='/canary/guides/errors/' class='nav-link'>Errors</a>
      
        <a href='/canary/guides/mailers/' class='nav-link'>Mailers</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>Data</div>
      
      
        <a href='/canary/guides/models/' class='nav-link'>Models</a>
      
        <a href='/canary/guides/serializers/' class='nav-link'>Serializers</a>
      
        <a href='/canary/guides/orm-adapters/' class='nav-link'>ORM Adapters</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>Testing</div>
      
      
        <a href='/canary/guides/integration/' class='nav-link'>Integration</a>
      
        <a href='/canary/guides/unit/' class='nav-link'>Unit Testing</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>Configuration</div>
      
      
        <a href='/canary/guides/environment/' class='nav-link'>Environment</a>
      
        <a href='/canary/guides/middleware/' class='nav-link'>Middleware</a>
      
        <a href='/canary/guides/initializers/' class='nav-link'>Initializers</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>Utilities</div>
      
      
        <a href='/canary/guides/mixins.js' class='nav-link'>Mixins</a>
      
        <a href='/canary/guides/addons/' class='nav-link'>Addons</a>
      
        <a href='/canary/guides/instrumentation/' class='nav-link'>Instrumentation</a>
      
    </div>
  
    <div class='nav-section'>
      
        <div class='nav-header'>CLI</div>
      
      
        <a href='/canary/guides/generate/' class='nav-link'>denali generate</a>
      
        <a href='/canary/guides/serve/' class='nav-link'>denali serve</a>
      
        <a href='/canary/guides/test/' class='nav-link'>denali test</a>
      
        <a href='/canary/guides/build/' class='nav-link'>denali build</a>
      
        <a href='/canary/guides/addon/' class='nav-link'>denali addon</a>
      
        <a href='/canary/guides/console/' class='nav-link'>denali console</a>
      
    </div>
  
</div>

    <div class='col-md-9 guides-body'>
      <a class="btn btn-info pull-xs-right" target="_blank" href="https://github.com/davewasmer/denali/edit/master/guides/quickstart.md">Improve this page</a>
      <h1 id="getting-started">Getting Started</h1>

<p>It’s that ever-favorite first project for a server side framework: let’s build a
basic blogging application!</p>

<h2 id="installation">Installation</h2>

<p>First off, make sure you install Denali globally via npm:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install -g denali
</code></pre>
</div>

<h2 id="scaffolding-our-application">Scaffolding our application</h2>

<p>Next, let’s use Denali’s handy scaffolding tools to create a blank slate for us
to start from:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>denali new blog
denali v0.1.0 <span class="o">[</span>global]
  create app/actions/application.js
  create app/actions/index.js
  create app/models/.gitkeep
  create app/serializers/.gitkeep
  create app/services/.gitkeep
  create config/environment.js
  create config/middleware.js
  create config/routes.js
  create <span class="nb">test</span>/helpers/.gitkeep
  create <span class="nb">test</span>/integration/.gitkeep
  create <span class="nb">test</span>/unit/.gitkeep
  create <span class="nb">test</span>/index.js
  create .babelrc
  create .eslintrc
  create .gitattributes
  create .gitignore
  create CHANGELOG.md
  create package.json
  create README.md

Installing npm dependencies ...
Setting up git repo ...

Installation <span class="nb">complete</span>!
To launch your application, just run:

  <span class="nv">$ </span><span class="nb">cd </span>blog <span class="o">&amp;&amp;</span> denali server

</code></pre>
</div>

<p>Go ahead and follow that last instruction:</p>

<pre><code class="language-txt">$ cd blog
$ denali server
denali v0.0.1
2015-09-13T23:21:44.404Z [INFO] blog@0.0.1 server up on port 3000
</code></pre>

<p>Perfect! You’ve got your first Denali app up and running. Now let’s see it in
action. Hit the root endpoint with curl:</p>

<pre><code class="language-txt">$ curl localhost:3000
{"denaliVersion":"0.0.1","message":"Welcome to Denali!"}
</code></pre>

<blockquote>
  <p><strong>Heads up!</strong> Notice that we didn’t visit that localhost URL in the browser.
That’s because Denali is designed to build <strong>APIs</strong> rather than HTML rendering
applications. If you are looking for Node framework to build a server rendered
web application, you might want to try something like Sails.js or Express.</p>
</blockquote>

<p>Great, we got an app up and running! Now that’s cool, but it’s not <em>that</em> cool
Let’s crack open the scaffolded code to see how that root endpoint is working,
and how to add our own.</p>

<h3 id="directory-structure">Directory structure</h3>

<p>The <code class="highlighter-rouge">denali new</code> command did a lot of setup for us. It created the following
directory structure:</p>

<pre><code class="language-txt">blog/
  app/
    actions/
      application.js
      index.js
    models/
    serializers/
  config/
    initializers/
    environment.js
    middleware.js
    routes.js
  test/
    helpers/
    integration/
    unit/
  .eslintrc
  CHANGELOG.md
  denali-build.js
  package.json
  README.md
</code></pre>

<p>There’s a lot there, but for now, let’s open up the <code class="highlighter-rouge">config/routes.js</code> to see
how that root endpoint is being handled:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// config/routes.js</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">drawRoutes</span><span class="p">(</span><span class="nx">router</span><span class="p">)</span> <span class="p">{</span>

  <span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="s1">'index'</span><span class="p">);</span>

<span class="p">}</span>
</code></pre>
</div>

<p>This should look somewhat familiar if you used frameworks like Rails before. The
<code class="highlighter-rouge">router.get()</code> method adds an endpoint that responds to GET requests at the url
provided in the first argument (<code class="highlighter-rouge">'/'</code> in this case).</p>

<p>The second argument identifies an action to route these requests to (in this
case, the <code class="highlighter-rouge">index</code> action).</p>

<p>In <code class="highlighter-rouge">app/actions/index.js</code>, we can see how that is handled:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/actions/index.js</span>
<span class="kr">import</span> <span class="nx">ApplicationAction</span> <span class="nx">from</span> <span class="s1">'./application'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">IndexAction</span> <span class="kr">extends</span> <span class="nx">ApplicationAction</span> <span class="p">{</span>

  <span class="nx">respond</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">message</span><span class="p">:</span> <span class="s1">'Welcome to Denali!'</span>
    <span class="p">},</span> <span class="p">{</span> <span class="na">raw</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Let’s break down what’s going on here:</p>

<ul>
  <li><code class="highlighter-rouge">import ApplicationAction from './application';</code> - we import the
  <code class="highlighter-rouge">ApplicationAction</code> to use as our common base class. You could import the base
  <code class="highlighter-rouge">Action</code> class from the <code class="highlighter-rouge">denali</code> module directly, but having a base class for
  all actions in your app is handy (and the convention).</li>
  <li><code class="highlighter-rouge">respond() {</code> - the <code class="highlighter-rouge">respond()</code> method is the meat of any action. It defines
  how the action responds to an incoming request.</li>
  <li><code class="highlighter-rouge">return new Response(...)</code> - you can tell Denali what to respond to a
  request with in a few different ways. Here, we return a <code class="highlighter-rouge">Response</code> object
  which has details of what kind of response we want to send. The <code class="highlighter-rouge">raw</code> option
  tells Denali not to send this payload through the serializer layer. More on
  that below!</li>
</ul>

<p>The end result here is an action which will always respond with the same JSON
object that we saw above: <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome to Denali!"</span><span class="w"> </span><span class="p">}</span></code>.</p>

<h2 id="adding-a-resource">Adding a resource</h2>

<p>Now let’s get a bit more creative. Our blog API is going to need to store and
retrieve our blog posts. Let’s create a Post resource to enable that.</p>

<blockquote>
  <p>Normally, you’d probably store those in some kind of database (i.e. Mongo,
Postgres, MySQL, etc). Denali is <strong>database agnostic</strong> though. So for now,
we’ll use plain ol’ JS objects (a.k.a. POJOs). But you could easily substitute
your own models in later. For more details, check out the Data guides.</p>
</blockquote>

<p>To start, let’s use that handy scaffolding tool again:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>denali generate resource posts
</code></pre>
</div>

<p>This scaffold creates several files:</p>

<ul>
  <li>
    <p>A set of <strong>actions</strong> for this resource with the basic CRUD operations
  stubbed out. These files are where you’ll implement your application logic to
  respond to a particular request. We saw these above.</p>
  </li>
  <li>
    <p>A <strong>serializer</strong> to determine how your Posts will be rendered in the
  response. We’ll learn more about this in a bit.</p>
  </li>
  <li>
    <p>A <strong>model</strong> to represent your Posts.</p>
  </li>
  <li>
    <p>A placeholder <strong>integration test suite</strong> for this resource. Denali comes
  with a first-class testing environment, setup and ready to go.</p>
  </li>
</ul>

<p>If we open up <code class="highlighter-rouge">app/actions/posts/</code> now, you can see the stubbed out actions:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="c1">// app/actions/posts/list.js</span>
  <span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">ListPosts</span> <span class="kr">extends</span> <span class="nx">ApplicationAction</span> <span class="p">{</span>
    <span class="nx">respond</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">Errors</span><span class="p">.</span><span class="nx">NotImplemented</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>Let’s go ahead and implement that list action now. We’ll just hardcode the Posts
into the response for now:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/controllers/posts.js</span>

  <span class="nx">respond</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">([</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'Denali is awesome'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'You are awesome!'</span>
      <span class="p">}</span>
      <span class="p">],</span> <span class="p">{</span> <span class="na">raw</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>Great! Let’s hit that endpoint now:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl localhost:3000/posts
<span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 1,
    <span class="s2">"title"</span>: <span class="s2">"Denali is awesome"</span>
  <span class="o">}</span>,
  <span class="o">{</span>
    <span class="s2">"id"</span>: 2,
    <span class="s2">"title"</span>: <span class="s2">"You are awesome!"</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
</div>

<h2 id="adding-a-database">Adding a database</h2>

<p>Hardcoded JSON still isn’t all that interesting. Let’s integrate with a data
store so consumers of the API can actually manipulate the data.</p>

<p>Denali takes a unique approach to handling database integrations. Most
frameworks ship with some kind of Object Relational Mapper (ORM) baked right in.
It transforms rows from a database into objects you can manipulate.</p>

<p>Here’s the thing: <strong>ORMs are hard. _Really hard.__</strong> To make matters worse,
there’s <strong>no generally accepted “good” ORM for Node.js</strong>.</p>

<p>With this in mind, Denali purposefully <strong>does not ship with an ORM</strong>. Instead,
Denali’s Models are essentially a thin adapter layer that lets you plug your
own ORM in instead.</p>

<p>There’s lots of reasons why this is a powerful approach, but those are covered
in the Data guides. For now, let’s forge ahead and setup our data store.</p>

<h3 id="memory-adapter">Memory Adapter</h3>

<p>Denali ships with an in-memory data store and ORM adapter, which can be useful
for testing and debugging use cases. It’s the default ORM for newly scaffolded
projects, so it’s already setup and ready to go. We’ll use it now to get going
without needing to setup an actual database.</p>

<h2 id="adding-a-model">Adding a model</h2>

<p>Let’s add a Post model that will represent one of our blog posts:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>denali generate model post
</code></pre>
</div>

<p>This creates <code class="highlighter-rouge">app/models/post.js</code>. Let’s open that up, and add our title
attribute:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">ApplicationModel</span> <span class="nx">from</span> <span class="s1">'./application'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Post</span> <span class="kr">extends</span> <span class="nx">ApplicationModel</span> <span class="p">{</span>

  <span class="kr">static</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">attr</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>

<span class="p">}</span>
</code></pre>
</div>

<p>Okay, let’s break this one down. First up, we follow the same pattern of having
a base “Application” class that we did with Actions:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">ApplicationModel</span> <span class="nx">from</span> <span class="s1">'./application'</span><span class="p">;</span>
</code></pre>
</div>

<p>Next, we create our <code class="highlighter-rouge">title</code> attribute (note the class properties syntax, and
that attributes are declared as static properties):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="kr">static</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">attr</span><span class="p">(</span><span class="s1">'text'</span><span class="p">);</span>
</code></pre>
</div>

<p>Now, back in our actions, we can use the Post model to find and return all our
posts:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/actions/posts/list.js</span>
  <span class="nx">respond</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">Post</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">modelFor</span><span class="p">(</span><span class="s1">'post'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">Post.find()</code> method, when invoked with no parameters, will return a Promise
that resolves with all the Post records.</p>

<p>Over in our create action, we can let the user create new blog posts too:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/actions/posts/create.js</span>
  <span class="nx">respond</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">Post</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">modelFor</span><span class="p">(</span><span class="s1">'post'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>Great! Now we can create and list all the Posts in our in-memory data store.
Let’s test it out:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl localhost:3000/posts -X POST -d <span class="s1">'{"title": "My first post!"}'</span>

<span class="o">{</span>
  <span class="s2">"id"</span>: 1
<span class="o">}</span>
</code></pre>
</div>

<p>Looks like our Post was created, but the <code class="highlighter-rouge">title</code> wasn’t returned. If we check
this listing endpoint:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl localhost:3000/posts

<span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 1
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
</div>

<p>It’s missing there too. What’s going on here?</p>

<h2 id="working-with-serializers">Working with Serializers</h2>

<p>The reason our <code class="highlighter-rouge">title</code> field was missing was because of our Serializers.</p>

<p>A Serializer takes an in-memory payload object (or array), and transforms into
JSON to send back in the response.</p>

<p>By default, Serializers are configured with a whitelist of which attributes are
allowed to be returned. Since we didn’t touch our PostSerializer yet, the
<code class="highlighter-rouge">title</code> attribute isn’t in that whitelist, so it gets stripped out on all our
responses.</p>

<p>Let’s fix that now by adding it to the whitelist:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">// app/serializers/post.js</span>
<span class="kr">import</span> <span class="nx">ApplicationSerializer</span> <span class="nx">from</span> <span class="s1">'./application'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">PostSerializer</span> <span class="kr">extends</span> <span class="nx">ApplicationSerializer</span> <span class="p">{</span>

  <span class="nx">attributes</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'title'</span> <span class="p">];</span>

<span class="p">}</span>
</code></pre>
</div>

<p>And now let’s try to list the posts again:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl localhost:3000/posts

<span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 1,
    <span class="s2">"title"</span>: <span class="s2">"My first post!"</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
</div>

<p>There it is! Our blog is off to a promising start.</p>

<h2 id="next-steps">Next Steps</h2>

<p>Congrats, you made it through the quickstart guide. From here, you can:</p>

<ul>
  <li>Check out the rest of the guides to learn more about the different parts of the framework</li>
  <li>Dive into the API documentation to get into the gritty details</li>
  <li>Explore the <a href="https://github.com/davewasmer/denali">heavily commented source code</a></li>
</ul>

    </div>
  </div>
</div>

<footer class="footer">

</footer>

<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
    e.src='//www.google-analytics.com/analytics.js';
    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-XXXXX-X','auto');ga('send','pageview');
</script>


  </body>
</html>
